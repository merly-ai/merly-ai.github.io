
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" href="../merly.css">
  <title>php-src Repo - TSRM\tsrm_win32.c Ctrl Expressions (98) - MerlyMentor</title>
</head>
<body>
  <h2>php-src Repo - TSRM\tsrm_win32.c Ctrl Expressions (98) - MerlyMentor</h2>
  
  <header>
    <nav>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Files" href="../index.html">Files</a></li>
        <li class="mr-3"><a title="Anomalies" href="../anomalies.html">Anomalies</a></li>
        <li class="mr-3"><a title="Notables" href="../notables.html">Notables</a></li>
        <li class="mr-3"><a title="Known Good" href="../known-good.html">Known Good</a></li>
        <li class="mr-3"><a title="Known Bad" href="../known-bad.html">Known Bad</a></li>
        
      </ul>
    </nav>
  </header>

  <fieldset>
    <legend>&nbsp;TSRM\tsrm_win32.c Ctrl Expressions (98)&nbsp;</legend>
    <table class="code">
      <tr class="th"><td class="num">Line</td><td>Ctrl Expression</td><td class="num">Score</td></tr>
      <tr><td class="num line">722</td><td><a href="tsrm_win32.c.html#L722">(<span style='background-color:#741da3;'>!ret && shm->descriptor->shm_nattch <= 0</span>)</a></td><td class="num">1012.00</td></tr>
      <tr><td class="num line">221</td><td><a href="tsrm_win32.c.html#L221">(<span style='background-color:#741da3;'>0 > ret || X_OK == mode || F_OK == mode</span>)</a></td><td class="num">1010.00</td></tr>
      <tr><td class="num line">674</td><td><a href="tsrm_win32.c.html#L674">(NULL != shm->descriptor && (shm->descriptor->shm_perm.key != key || size > shm->descriptor->shm_segsz))</a></td><td class="num">42.00</td></tr>
      <tr><td class="num line">475</td><td><a href="tsrm_win32.c.html#L475">(type_len > 1 && (ptype[1] != 'b' && ptype[1] != 't'))</a></td><td class="num">32.00</td></tr>
      <tr><td class="num line">504</td><td><a href="tsrm_win32.c.html#L504">(!type_len || !CreatePipe(&in, &out, &security, 2048L))</a></td><td class="num">26.50</td></tr>
      <tr><td class="num line">322</td><td><a href="tsrm_win32.c.html#L322">(psec_desc == NULL || !GetFileSecurityW(pathw, sec_info, (PSECURITY_DESCRIPTOR)psec_desc, sec_desc_length, &sec_desc_length))</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">206</td><td><a href="tsrm_win32.c.html#L206">(!IS_ABSOLUTE_PATH(pathname, strlen(pathname) + 1))</a></td><td class="num">19.85</td></tr>
      <tr><td class="num line">263</td><td><a href="tsrm_win32.c.html#L263">(!DuplicateToken(thread_token, SecurityImpersonation, &TWG(impersonation_token)))</a></td><td class="num">19.75</td></tr>
      <tr><td class="num line">256</td><td><a href="tsrm_win32.c.html#L256">(!TWG(impersonation_token_sid) || !EqualSid(token_sid, TWG(impersonation_token_sid)))</a></td><td class="num">19.25</td></tr>
      <tr><td class="num line">305</td><td><a href="tsrm_win32.c.html#L305">(bucket != NULL && bucket->is_rvalid && bucket->is_wvalid)</a></td><td class="num">15.00</td></tr>
      <tr><td class="num line">406</td><td><a href="tsrm_win32.c.html#L406">(!addr && ptr->descriptor->shm_perm.key == key)</a></td><td class="num">13.25</td></tr>
      <tr><td class="num line">80</td><td><a href="tsrm_win32.c.html#L80">(globals->impersonation_token && globals->impersonation_token != INVALID_HANDLE_VALUE)</a></td><td class="num">12.50</td></tr>
      <tr><td class="num line">329</td><td><a href="tsrm_win32.c.html#L329">(!AccessCheck((PSECURITY_DESCRIPTOR)psec_desc, TWG(impersonation_token), desired_access, &gen_map, &privilege_set, &priv_set_length, &granted_access, &fAccess))</a></td><td class="num">12.50</td></tr>
      <tr><td class="num line">471</td><td><a href="tsrm_win32.c.html#L471">(ptype[0] != 'r' && ptype[0] != 'w')</a></td><td class="num">11.75</td></tr>
      <tr><td class="num line">71</td><td><a href="tsrm_win32.c.html#L71">(ptr < (globals->shm + globals->shm_size))</a></td><td class="num">11.10</td></tr>
      <tr><td class="num line">595</td><td><a href="tsrm_win32.c.html#L595">((process = process_get(stream)) == NULL)</a></td><td class="num">9.75</td></tr>
      <tr><td class="num line">287</td><td><a href="tsrm_win32.c.html#L287">(bucket != NULL && bucket->is_rvalid)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">293</td><td><a href="tsrm_win32.c.html#L293">(bucket != NULL && bucket->is_wvalid)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">299</td><td><a href="tsrm_win32.c.html#L299">(bucket != NULL && bucket->is_rvalid)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">660</td><td><a href="tsrm_win32.c.html#L660">(NULL != shm->descriptor && created)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">274</td><td><a href="tsrm_win32.c.html#L274">(bucket == NULL && !real_path[0])</a></td><td class="num">8.50</td></tr>
      <tr><td class="num line">750</td><td><a href="tsrm_win32.c.html#L750">(shm->descriptor->shm_nattch < 1)</a></td><td class="num">7.50</td></tr>
      <tr><td class="num line">286</td><td><a href="tsrm_win32.c.html#L286">(mode == 0 || mode > 6)</a></td><td class="num">6.75</td></tr>
      <tr><td class="num line">467</td><td><a href="tsrm_win32.c.html#L467">(type_len < 1 || type_len > 2)</a></td><td class="num">6.75</td></tr>
      <tr><td class="num line">172</td><td><a href="tsrm_win32.c.html#L172">(!CopySid(sid_len, pResultSid, pTokenUser->User.Sid))</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">377</td><td><a href="tsrm_win32.c.html#L377">(ptr->stream == stream)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">408</td><td><a href="tsrm_win32.c.html#L408">(ptr->addr == addr)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">675</td><td><a href="tsrm_win32.c.html#L675">(NULL != shm->segment)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">695</td><td><a href="tsrm_win32.c.html#L695">(NULL == shm->addr)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">805</td><td><a href="tsrm_win32.c.html#L805">(!SetFileTime(hFile, NULL, &atime, &mtime))</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">376</td><td><a href="tsrm_win32.c.html#L376">(ptr < (TWG(process) + TWG(process_size)))</a></td><td class="num">5.10</td></tr>
      <tr><td class="num line">382</td><td><a href="tsrm_win32.c.html#L382">(ptr < (TWG(process) + TWG(process_size)))</a></td><td class="num">5.10</td></tr>
      <tr><td class="num line">402</td><td><a href="tsrm_win32.c.html#L402">(ptr < (TWG(shm) + TWG(shm_size)))</a></td><td class="num">5.10</td></tr>
      <tr><td class="num line">413</td><td><a href="tsrm_win32.c.html#L413">(ptr < (TWG(shm) + TWG(shm_size)))</a></td><td class="num">5.10</td></tr>
      <tr><td class="num line">403</td><td><a href="tsrm_win32.c.html#L403">(!ptr->descriptor)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">532</td><td><a href="tsrm_win32.c.html#L532">(strcmp(sapi_module.name, "cli") != 0)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">689</td><td><a href="tsrm_win32.c.html#L689">(!shm->segment)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">713</td><td><a href="tsrm_win32.c.html#L713">(!shm->segment)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">733</td><td><a href="tsrm_win32.c.html#L733">(!shm->segment)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">236</td><td><a href="tsrm_win32.c.html#L236">(!OpenThreadToken(GetCurrentThread(), TOKEN_ALL_ACCESS, true, &thread_token))</a></td><td class="num">3.50</td></tr>
      <tr><td class="num line">238</td><td><a href="tsrm_win32.c.html#L238">(!OpenProcessToken(GetCurrentProcess(), TOKEN_ALL_ACCESS, &thread_token))</a></td><td class="num">3.50</td></tr>
      <tr><td class="num line">66</td><td><a href="tsrm_win32.c.html#L66">(globals->process)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">70</td><td><a href="tsrm_win32.c.html#L70">(globals->shm)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">83</td><td><a href="tsrm_win32.c.html#L83">(globals->impersonation_token_sid)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">116</td><td><a href="tsrm_win32.c.html#L116">(!ConvertSidToStringSid(pSid, &ptcSid))</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">147</td><td><a href="tsrm_win32.c.html#L147">(!GetTokenInformation(hToken, TokenUser, (LPVOID)pTokenUser, 0, &dwLength))</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">160</td><td><a href="tsrm_win32.c.html#L160">(!GetTokenInformation(hToken, TokenUser, (LPVOID)pTokenUser, dwLength, &dwLength))</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">432</td><td><a href="tsrm_win32.c.html#L432">(!DuplicateHandle(self, fh, self, &copy, 0, inherit, DUPLICATE_SAME_ACCESS | DUPLICATE_CLOSE_SOURCE))</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">627</td><td><a href="tsrm_win32.c.html#L627">(flags & IPC_CREAT)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">646</td><td><a href="tsrm_win32.c.html#L646">(flags & IPC_EXCL)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">537</td><td><a href="tsrm_win32.c.html#L537">(OpenThreadToken(GetCurrentThread(), TOKEN_ALL_ACCESS, true, &thread_token))</a></td><td class="num">2.75</td></tr>
      <tr><td class="num line">149</td><td><a href="tsrm_win32.c.html#L149">(GetLastError() != ERROR_INSUFFICIENT_BUFFER)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">207</td><td><a href="tsrm_win32.c.html#L207">(tsrm_realpath(pathname, real_path) == NULL)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">237</td><td><a href="tsrm_win32.c.html#L237">(GetLastError() == ERROR_NO_TOKEN)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">277</td><td><a href="tsrm_win32.c.html#L277">(tsrm_realpath(pathname, real_path) != NULL)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">312</td><td><a href="tsrm_win32.c.html#L312">(TWG(impersonation_token) == NULL)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">317</td><td><a href="tsrm_win32.c.html#L317">(GetFileSecurityW(pathw, sec_info, NULL, 0, &sec_desc_length))</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">788</td><td><a href="tsrm_win32.c.html#L788">(GetLastError() == ERROR_ALREADY_EXISTS)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">154</td><td><a href="tsrm_win32.c.html#L154">(pTokenUser == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">183</td><td><a href="tsrm_win32.c.html#L183">(pTokenUser != NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">292</td><td><a href="tsrm_win32.c.html#L292">(mode <= 2)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">298</td><td><a href="tsrm_win32.c.html#L298">(mode <= 4)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">334</td><td><a href="tsrm_win32.c.html#L334">(bucket != NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">335</td><td><a href="tsrm_win32.c.html#L335">(desired_access == FILE_GENERIC_READ | FILE_FLAG_BACKUP_SEMANTICS)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">339</td><td><a href="tsrm_win32.c.html#L339">(desired_access == FILE_GENERIC_WRITE)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">342</td><td><a href="tsrm_win32.c.html#L342">(desired_access == FILE_GENERIC_READ | FILE_GENERIC_WRITE)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">351</td><td><a href="tsrm_win32.c.html#L351">(psec_desc != NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">357</td><td><a href="tsrm_win32.c.html#L357">(thread_token != NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">362</td><td><a href="tsrm_win32.c.html#L362">(fAccess == false)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">387</td><td><a href="tsrm_win32.c.html#L387">(newptr == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">418</td><td><a href="tsrm_win32.c.html#L418">(newptr == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">541</td><td><a href="tsrm_win32.c.html#L541">(err == ERROR_NO_TOKEN)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">620</td><td><a href="tsrm_win32.c.html#L620">(key != IPC_PRIVATE)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">628</td><td><a href="tsrm_win32.c.html#L628">(size > SIZE_MAX - sizeof(shm->descriptor))</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">792</td><td><a href="tsrm_win32.c.html#L792">(hFile == INVALID_HANDLE_VALUE)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">111</td><td><a href="tsrm_win32.c.html#L111">(!pSid)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">125</td><td><a href="tsrm_win32.c.html#L125">(!bucket_key)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">169</td><td><a href="tsrm_win32.c.html#L169">(!pResultSid)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">247</td><td><a href="tsrm_win32.c.html#L247">(!token_sid)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">462</td><td><a href="tsrm_win32.c.html#L462">(!type)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">480</td><td><a href="tsrm_win32.c.html#L480">(!cmd)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">486</td><td><a href="tsrm_win32.c.html#L486">(!cmdw)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">493</td><td><a href="tsrm_win32.c.html#L493">(!cwdw)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">569</td><td><a href="tsrm_win32.c.html#L569">(!res)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">626</td><td><a href="tsrm_win32.c.html#L626">(!shm_handle)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">642</td><td><a href="tsrm_win32.c.html#L642">(!shm_handle)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">653</td><td><a href="tsrm_win32.c.html#L653">(!shm)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">796</td><td><a href="tsrm_win32.c.html#L796">(!buf)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">248</td><td><a href="tsrm_win32.c.html#L248">(TWG(impersonation_token_sid))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">257</td><td><a href="tsrm_win32.c.html#L257">(TWG(impersonation_token_sid))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">271</td><td><a href="tsrm_win32.c.html#L271">(CWDG(realpath_cache_size_limit))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">179</td><td><a href="tsrm_win32.c.html#L179">(pResultSid)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">491</td><td><a href="tsrm_win32.c.html#L491">(cwd)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">521</td><td><a href="tsrm_win32.c.html#L521">(read)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">547</td><td><a href="tsrm_win32.c.html#L547">(envw)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">550</td><td><a href="tsrm_win32.c.html#L550">(env)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">558</td><td><a href="tsrm_win32.c.html#L558">(asuser)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">576</td><td><a href="tsrm_win32.c.html#L576">(read)</a></td><td class="num">0.00</td></tr>

    </table>
  </fieldset>
  
  <footer class="footer width-full container-xl p-responsive">
    <nav>
      <p></p>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Merly" href="https://merly.ai">© 2022 Merly, Inc.</a></li>
        <!--
        <li class="mr-3"><a>Terms</a></li>
        <li class="mr-3"><a>Privacy</a></li>
        <li class="mr-3"><a>Security</a></li>
        -->
        <li class="mr-3"><a href="https://merly.ai/_files/ugd/c392f8_90d33fd2e7644dcd9aa97ac2b7736c75.pdf">User Manual</a></li>
        <li class="mr-3"><a href="mailto:sales@merly.ai">Contact Merly</a></li>
        <li class="mr-3"><a href="https://merly.ai/mentor-pricing">Pricing</a></li>
        <li class="mr-3"><a href="https://merly.ai/timeline">About</a></li>
      </ul>
    </nav>
  </footer>

</body>
</html>
