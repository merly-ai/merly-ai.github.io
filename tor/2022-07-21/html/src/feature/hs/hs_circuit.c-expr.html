
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" href="../../../merly.css">
  <title>tor Repo - src\feature\hs\hs_circuit.c Ctrl Expressions (66) - MerlyMentor</title>
</head>
<body>
  <h2>tor Repo - src\feature\hs\hs_circuit.c Ctrl Expressions (66) - MerlyMentor</h2>
  
  <header>
    <nav>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Files" href="../../../index.html">Files</a></li>
        <li class="mr-3"><a title="Anomalies" href="../../../anomalies.html">Anomalies</a></li>
        <li class="mr-3"><a title="Notables" href="../../../notables.html">Notables</a></li>
        <li class="mr-3"><a title="Known Good" href="../../../known-good.html">Known Good</a></li>
        <li class="mr-3"><a title="Known Bad" href="../../../known-bad.html">Known Bad</a></li>
        
      </ul>
    </nav>
  </header>

  <fieldset>
    <legend>&nbsp;src\feature\hs\hs_circuit.c Ctrl Expressions (66)&nbsp;</legend>
    <table class="code">
      <tr class="th"><td class="num">Line</td><td>Ctrl Expression</td><td class="num">Score</td></tr>
      <tr><td class="num line">458</td><td><a href="hs_circuit.c.html#L458">(<span style='background-color:#741da3;'>circ->build_state->failure_count > max_rend_failures || circ->build_state->expiry_time <= time(NULL)</span>)</a></td><td class="num">1017.50</td></tr>
      <tr><td class="num line">1072</td><td><a href="hs_circuit.c.html#L1072">(BUG(!circuit_purpose_is_correct_for_rend(TO_CIRCUIT(circ)->purpose, is_service_side)))</a></td><td class="num">58.75</td></tr>
      <tr><td class="num line">926</td><td><a href="hs_circuit.c.html#L926">(BUG(TO_CIRCUIT(circ)->purpose != CIRCUIT_PURPOSE_S_ESTABLISH_INTRO))</a></td><td class="num">43.75</td></tr>
      <tr><td class="num line">399</td><td><a href="hs_circuit.c.html#L399">(hs_ntor_service_get_rendezvous1_keys(&ip->auth_key_kp.pubkey, &ip->enc_key_kp, &ephemeral_kp, &data->client_pk, &keys) < 0)</a></td><td class="num">40.50</td></tr>
      <tr><td class="num line">739</td><td><a href="hs_circuit.c.html#L739">(BUG(!service->config.is_single_onion && direct_conn))</a></td><td class="num">27.00</td></tr>
      <tr><td class="num line">816</td><td><a href="hs_circuit.c.html#L816">(circuit_should_use_vanguards(TO_CIRCUIT(circ)->purpose))</a></td><td class="num">23.75</td></tr>
      <tr><td class="num line">135</td><td><a href="hs_circuit.c.html#L135">(TO_CIRCUIT(circ)->ccontrol)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">522</td><td><a href="hs_circuit.c.html#L522">(TO_CIRCUIT(circ)->ccontrol)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">643</td><td><a href="hs_circuit.c.html#L643">(get_options()->HSLayer3Nodes)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">1138</td><td><a href="hs_circuit.c.html#L1138">(TO_CIRCUIT(rend_circ)->ccontrol)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">187</td><td><a href="hs_circuit.c.html#L187">(!circ->marked_for_close && circ->state == CIRCUIT_STATE_OPEN)</a></td><td class="num">13.25</td></tr>
      <tr><td class="num line">357</td><td><a href="hs_circuit.c.html#L357">(service->config.is_single_onion && i == 0)</a></td><td class="num">10.50</td></tr>
      <tr><td class="num line">744</td><td><a href="hs_circuit.c.html#L744">(direct_conn && ip->circuit_retries == 1)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">1029</td><td><a href="hs_circuit.c.html#L1029">(replaycache_add_test_and_elapsed(service->state.replay_cache_rend_cookie, data.rendezvous_cookie, sizeof(data.rendezvous_cookie), &elapsed))</a></td><td class="num">8.50</td></tr>
      <tr><td class="num line">64</td><td><a href="hs_circuit.c.html#L64">(circ_purpose != CIRCUIT_PURPOSE_C_REND_READY && circ_purpose != CIRCUIT_PURPOSE_C_REND_READY_INTRO_ACKED)</a></td><td class="num">8.25</td></tr>
      <tr><td class="num line">278</td><td><a href="hs_circuit.c.html#L278">(relay_send_command_from_edge(CONTROL_CELL_ID, TO_CIRCUIT(circ), RELAY_COMMAND_ESTABLISH_INTRO, (char *)payload, cell_len, circ->cpath->prev) < 0)</a></td><td class="num">8.00</td></tr>
      <tr><td class="num line">884</td><td><a href="hs_circuit.c.html#L884">(relay_send_command_from_edge(CONTROL_CELL_ID, TO_CIRCUIT(circ), RELAY_COMMAND_RENDEZVOUS1, (const char *)payload, payload_len, circ->cpath->prev) < 0)</a></td><td class="num">8.00</td></tr>
      <tr><td class="num line">1159</td><td><a href="hs_circuit.c.html#L1159">(relay_send_command_from_edge(CONTROL_CELL_ID, TO_CIRCUIT(intro_circ), RELAY_COMMAND_INTRODUCE1, (const char *)payload, payload_len, intro_circ->cpath->prev) < 0)</a></td><td class="num">8.00</td></tr>
      <tr><td class="num line">1215</td><td><a href="hs_circuit.c.html#L1215">(relay_send_command_from_edge(CONTROL_CELL_ID, TO_CIRCUIT(circ), RELAY_COMMAND_ESTABLISH_RENDEZVOUS, (const char *)cell, cell_len, circ->cpath->prev) < 0)</a></td><td class="num">8.00</td></tr>
      <tr><td class="num line">897</td><td><a href="hs_circuit.c.html#L897">(hs_circuit_setup_e2e_rend_circ(circ, circ->hs_ident->rendezvous_ntor_key_seed, sizeof(circ->hs_ident->rendezvous_ntor_key_seed), 1) < 0)</a></td><td class="num">7.75</td></tr>
      <tr><td class="num line">1347</td><td><a href="hs_circuit.c.html#L1347">(curve25519_public_key_is_ok(&circ->hs_ident->intro_enc_pk))</a></td><td class="num">7.75</td></tr>
      <tr><td class="num line">572</td><td><a href="hs_circuit.c.html#L572">(intro1_data->onion_pk == NULL)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">977</td><td><a href="hs_circuit.c.html#L977">(BUG(!service->state.ob_subcreds))</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">1024</td><td><a href="hs_circuit.c.html#L1024">(hs_cell_parse_introduce2(&data, circ, service) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">1130</td><td><a href="hs_circuit.c.html#L1130">(setup_introduce1_data(ip, exit_node, subcredential, &intro1_data) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">304</td><td><a href="hs_circuit.c.html#L304">(service->config.is_single_onion)</a></td><td class="num">4.50</td></tr>
      <tr><td class="num line">1268</td><td><a href="hs_circuit.c.html#L1268">(circuit_purpose_is_hs_client(circ->purpose))</a></td><td class="num">3.50</td></tr>
      <tr><td class="num line">1272</td><td><a href="hs_circuit.c.html#L1272">(circuit_purpose_is_hs_service(circ->purpose))</a></td><td class="num">3.50</td></tr>
      <tr><td class="num line">1296</td><td><a href="hs_circuit.c.html#L1296">(circuit_purpose_is_hs_client(circ->purpose))</a></td><td class="num">3.50</td></tr>
      <tr><td class="num line">420</td><td><a href="hs_circuit.c.html#L420">(data->cc_enabled)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">443</td><td><a href="hs_circuit.c.html#L443">(circ->hs_service_side_rend_circ_has_been_relaunched)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">707</td><td><a href="hs_circuit.c.html#L707">(circ->hs_ident)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1281</td><td><a href="hs_circuit.c.html#L1281">(circ->hs_token)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1302</td><td><a href="hs_circuit.c.html#L1302">(circ->hs_token)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1319</td><td><a href="hs_circuit.c.html#L1319">(circ->hs_token)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1345</td><td><a href="hs_circuit.c.html#L1345">(circ->hs_ident)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">89</td><td><a href="hs_circuit.c.html#L89">(hs_ntor_circuit_key_expansion(ntor_key_seed, seed_len, keys, sizeof(keys)) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">98</td><td><a href="hs_circuit.c.html#L98">(cpath_init_circuit_crypto(cpath, (char*)keys, sizeof(keys), is_service_side, 1) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">559</td><td><a href="hs_circuit.c.html#L559">(smartlist_len(rp_lspecs) == 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">932</td><td><a href="hs_circuit.c.html#L932">(hs_cell_parse_intro_established(payload, payload_len) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">1019</td><td><a href="hs_circuit.c.html#L1019">(get_subcredential_for_handling_intro2_cell(service, &data, subcredential))</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">1155</td><td><a href="hs_circuit.c.html#L1155">(BUG(payload_len < 0))</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">1211</td><td><a href="hs_circuit.c.html#L1211">(BUG(cell_len < 0))</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">56</td><td><a href="hs_circuit.c.html#L56">(circ_purpose != CIRCUIT_PURPOSE_S_CONNECT_REND)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">177</td><td><a href="hs_circuit.c.html#L177">(ocirc == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">269</td><td><a href="hs_circuit.c.html#L269">(cell_len < 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">337</td><td><a href="hs_circuit.c.html#L337">(info == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">347</td><td><a href="hs_circuit.c.html#L347">(i < MAX_REND_FAILURES)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">363</td><td><a href="hs_circuit.c.html#L363">(circ != NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">368</td><td><a href="hs_circuit.c.html#L368">(circ == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">509</td><td><a href="hs_circuit.c.html#L509">(new_circ == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">758</td><td><a href="hs_circuit.c.html#L758">(circ == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">797</td><td><a href="hs_circuit.c.html#L797">(num_intro_circ > num_needed_circ)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">878</td><td><a href="hs_circuit.c.html#L878">(payload_len < HS_LEGACY_RENDEZVOUS_CELL_SIZE)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">1122</td><td><a href="hs_circuit.c.html#L1122">(exit_node == NULL)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">698</td><td><a href="hs_circuit.c.html#L698">(!can_relaunch_service_rendezvous_point(circ))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">969</td><td><a href="hs_circuit.c.html#L969">(!hs_ob_service_is_instance(service))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">63</td><td><a href="hs_circuit.c.html#L63">(!is_service_side)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">144</td><td><a href="hs_circuit.c.html#L144">(!is_service_side)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">1079</td><td><a href="hs_circuit.c.html#L1079">(!hop)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">591</td><td><a href="hs_circuit.c.html#L591">(circuit_is_hs_v3(circ))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">605</td><td><a href="hs_circuit.c.html#L605">(circuit_is_hs_v3(circ))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">1273</td><td><a href="hs_circuit.c.html#L1273">(circuit_is_hs_v3(circ))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">55</td><td><a href="hs_circuit.c.html#L55">(is_service_side)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">349</td><td><a href="hs_circuit.c.html#L349">(circ_needs_uptime)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">640</td><td><a href="hs_circuit.c.html#L640">(is_single_onion)</a></td><td class="num">0.00</td></tr>

    </table>
  </fieldset>
  
  <footer class="footer width-full container-xl p-responsive">
    <nav>
      <p></p>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Merly" href="https://merly.ai">Â© 2022 Merly, Inc.</a></li>
        <!--
        <li class="mr-3"><a>Terms</a></li>
        <li class="mr-3"><a>Privacy</a></li>
        <li class="mr-3"><a>Security</a></li>
        -->
        <li class="mr-3"><a href="https://merly.ai/_files/ugd/c392f8_90d33fd2e7644dcd9aa97ac2b7736c75.pdf">User Manual</a></li>
        <li class="mr-3"><a href="mailto:sales@merly.ai">Contact Merly</a></li>
        <li class="mr-3"><a href="https://merly.ai/mentor-pricing">Pricing</a></li>
        <li class="mr-3"><a href="https://merly.ai/timeline">About</a></li>
      </ul>
    </nav>
  </footer>

</body>
</html>
