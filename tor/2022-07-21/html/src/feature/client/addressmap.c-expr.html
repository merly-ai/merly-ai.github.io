
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" href="../../../merly.css">
  <title>tor Repo - src\feature\client\addressmap.c Ctrl Expressions (118) - MerlyMentor</title>
</head>
<body>
  <h2>tor Repo - src\feature\client\addressmap.c Ctrl Expressions (118) - MerlyMentor</h2>
  
  <header>
    <nav>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Files" href="../../../index.html">Files</a></li>
        <li class="mr-3"><a title="Anomalies" href="../../../anomalies.html">Anomalies</a></li>
        <li class="mr-3"><a title="Notables" href="../../../notables.html">Notables</a></li>
        <li class="mr-3"><a title="Known Good" href="../../../known-good.html">Known Good</a></li>
        <li class="mr-3"><a title="Known Bad" href="../../../known-bad.html">Known Bad</a></li>
        
      </ul>
    </nav>
  </header>

  <fieldset>
    <legend>&nbsp;src\feature\client\addressmap.c Ctrl Expressions (118)&nbsp;</legend>
    <table class="code">
      <tr class="th"><td class="num">Line</td><td>Ctrl Expression</td><td class="num">Score</td></tr>
      <tr><td class="num line">469</td><td><a href="addressmap.c.html#L469">(<span style='background-color:#741da3;'>!strcmpend(address, ".exit") && strcmpend(addr_orig, ".exit") && exit_source == ADDRMAPSRC_NONE</span>)</a></td><td class="num">1009.75</td></tr>
      <tr><td class="num line">776</td><td><a href="addressmap.c.html#L776">((f == AF_INET && !for_conn->entry_cfg.cache_ipv4_answers) || (f == AF_INET6 && !for_conn->entry_cfg.cache_ipv6_answers))</a></td><td class="num">39.50</td></tr>
      <tr><td class="num line">410</td><td><a href="addressmap.c.html#L410">(ent->src_wildcard && !ent->dst_wildcard && !strcasecmp(address, ent->new_address))</a></td><td class="num">30.50</td></tr>
      <tr><td class="num line">869</td><td><a href="addressmap.c.html#L869">(tor_addr_compare_masked(&addr, &conf->addr, conf->bits, CMP_EXACT) == 0)</a></td><td class="num">29.25</td></tr>
      <tr><td class="num line">183</td><td><a href="addressmap.c.html#L183">(ent->source == ADDRMAPSRC_TRACKEXIT && !strcmpend(ent->new_address, suffix))</a></td><td class="num">27.75</td></tr>
      <tr><td class="num line">235</td><td><a href="addressmap.c.html#L235">(!node || (allow_nodes && !routerset_contains_node(allow_nodes, node)) || routerset_contains_node(exclude_nodes, node) || !hostname_in_track_host_exits(options, address))</a></td><td class="num">26.75</td></tr>
      <tr><td class="num line">1025</td><td><a href="addressmap.c.html#L1025">(ent && ent->new_address && !strcasecmp(new_address, ent->new_address))</a></td><td class="num">26.50</td></tr>
      <tr><td class="num line">587</td><td><a href="addressmap.c.html#L587">(!new_address || (!strcasecmp(address, new_address) && wildcard_addr == wildcard_new_addr))</a></td><td class="num">25.75</td></tr>
      <tr><td class="num line">1085</td><td><a href="addressmap.c.html#L1085">(get_options()->AllowNonRFC953Hostnames)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">1088</td><td><a href="addressmap.c.html#L1088">(get_options()->ServerDNSAllowNonRFC953Hostnames)</a></td><td class="num">23.50</td></tr>
      <tr><td class="num line">291</td><td><a href="addressmap.c.html#L291">(!remove_this && !address_is_in_virtual_range(ent->new_address))</a></td><td class="num">23.00</td></tr>
      <tr><td class="num line">1100</td><td><a href="addressmap.c.html#L1100">(TOR_ISALNUM(*address) || *address == '-' || *address == '.' || *address == '_')</a></td><td class="num">20.25</td></tr>
      <tr><td class="num line">154</td><td><a href="addressmap.c.html#L154">(!ve->ipv4_address && !ve->ipv6_address && !ve->hostname_address)</a></td><td class="num">18.25</td></tr>
      <tr><td class="num line">477</td><td><a href="addressmap.c.html#L477">(ent->expires > 1 && ent->expires < expires)</a></td><td class="num">14.75</td></tr>
      <tr><td class="num line">1133</td><td><a href="addressmap.c.html#L1133">(val->expires >= min_expires && val->expires <= max_expires)</a></td><td class="num">14.75</td></tr>
      <tr><td class="num line">959</td><td><a href="addressmap.c.html#L959">((a & 0xff) == 0 || (a & 0xff) == 0xff)</a></td><td class="num">13.25</td></tr>
      <tr><td class="num line">1142</td><td><a href="addressmap.c.html#L1142">(val->expires < 3 || val->expires == TIME_MAX)</a></td><td class="num">13.25</td></tr>
      <tr><td class="num line">142</td><td><a href="addressmap.c.html#L142">(ent && ent->new_address && address_is_in_virtual_range(ent->new_address))</a></td><td class="num">13.00</td></tr>
      <tr><td class="num line">229</td><td><a href="addressmap.c.html#L229">(dot > target && *dot != '.')</a></td><td class="num">10.50</td></tr>
      <tr><td class="num line">433</td><td><a href="addressmap.c.html#L433">(f == AF_INET && !(flags & AMR_FLAG_USE_IPV4_DNS))</a></td><td class="num">10.00</td></tr>
      <tr><td class="num line">435</td><td><a href="addressmap.c.html#L435">(f == AF_INET6 && !(flags & AMR_FLAG_USE_IPV6_DNS))</a></td><td class="num">10.00</td></tr>
      <tr><td class="num line">513</td><td><a href="addressmap.c.html#L513">(f == AF_INET && !(flags & AMR_FLAG_USE_IPV4_DNS))</a></td><td class="num">10.00</td></tr>
      <tr><td class="num line">515</td><td><a href="addressmap.c.html#L515">(f == AF_INET6 && !(flags & AMR_FLAG_USE_IPV6_DNS))</a></td><td class="num">10.00</td></tr>
      <tr><td class="num line">610</td><td><a href="addressmap.c.html#L610">(address_is_in_virtual_range(ent->new_address) && expires != 2)</a></td><td class="num">9.50</td></tr>
      <tr><td class="num line">549</td><td><a href="addressmap.c.html#L549">(update_expiry && ent->source == ADDRMAPSRC_TRACKEXIT)</a></td><td class="num">9.25</td></tr>
      <tr><td class="num line">547</td><td><a href="addressmap.c.html#L547">(!(ent = strmap_get_lc(addressmap, address)))</a></td><td class="num">8.25</td></tr>
      <tr><td class="num line">461</td><td><a href="addressmap.c.html#L461">(ent->dst_wildcard && !exact_match)</a></td><td class="num">7.75</td></tr>
      <tr><td class="num line">355</td><td><a href="addressmap.c.html#L355">((cp = strchr(cp, '.')))</a></td><td class="num">7.50</td></tr>
      <tr><td class="num line">358</td><td><a href="addressmap.c.html#L358">(val && val->src_wildcard)</a></td><td class="num">7.00</td></tr>
      <tr><td class="num line">404</td><td><a href="addressmap.c.html#L404">(!ent || !ent->new_address)</a></td><td class="num">7.00</td></tr>
      <tr><td class="num line">420</td><td><a href="addressmap.c.html#L420">(!ent || !ent->new_address)</a></td><td class="num">7.00</td></tr>
      <tr><td class="num line">812</td><td><a href="addressmap.c.html#L812">(!val || val[0] == '\0')</a></td><td class="num">7.00</td></tr>
      <tr><td class="num line">818</td><td><a href="addressmap.c.html#L818">(tor_addr_parse_mask_ports(val, 0, &addr, &bits, NULL, NULL) < 0)</a></td><td class="num">7.00</td></tr>
      <tr><td class="num line">831</td><td><a href="addressmap.c.html#L831">(port_min != 1 || port_max != 65535)</a></td><td class="num">6.75</td></tr>
      <tr><td class="num line">938</td><td><a href="addressmap.c.html#L938">(type == RESOLVED_TYPE_IPV4 || type == RESOLVED_TYPE_IPV6)</a></td><td class="num">6.75</td></tr>
      <tr><td class="num line">903</td><td><a href="addressmap.c.html#L903">(conf->bits & 7)</a></td><td class="num">6.50</td></tr>
      <tr><td class="num line">206</td><td><a href="addressmap.c.html#L206">(allow_nodes == NULL && routerset_is_empty(exclude_nodes))</a></td><td class="num">6.25</td></tr>
      <tr><td class="num line">221</td><td><a href="addressmap.c.html#L221">(ent->source != ADDRMAPSRC_TRACKEXIT)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">284</td><td><a href="addressmap.c.html#L284">(ent->source != ADDRMAPSRC_AUTOMAP)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">646</td><td><a href="addressmap.c.html#L646">(ent->num_resolve_failures < SHRT_MAX)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">901</td><td><a href="addressmap.c.html#L901">(conf->bits >= 8)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">744</td><td><a href="addressmap.c.html#L744">(!for_conn->entry_cfg.cache_ipv4_answers)</a></td><td class="num">5.25</td></tr>
      <tr><td class="num line">747</td><td><a href="addressmap.c.html#L747">(!for_conn->entry_cfg.cache_ipv6_answers)</a></td><td class="num">5.25</td></tr>
      <tr><td class="num line">740</td><td><a href="addressmap.c.html#L740">(tor_addr_parse(&addr_tmp, address) >= 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">824</td><td><a href="addressmap.c.html#L824">(tor_addr_family(&addr) != family)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">866</td><td><a href="addressmap.c.html#L866">(tor_addr_parse(&addr, address) >= 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">1095</td><td><a href="addressmap.c.html#L1095">(tor_addr_parse(&a, address) >= 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">231</td><td><a href="addressmap.c.html#L231">(*dot == '.')</a></td><td class="num">4.50</td></tr>
      <tr><td class="num line">148</td><td><a href="addressmap.c.html#L148">(!strcmp(address, ve->ipv4_address))</a></td><td class="num">4.25</td></tr>
      <tr><td class="num line">150</td><td><a href="addressmap.c.html#L150">(!strcmp(address, ve->ipv6_address))</a></td><td class="num">4.25</td></tr>
      <tr><td class="num line">152</td><td><a href="addressmap.c.html#L152">(!strcmp(address, ve->hostname_address))</a></td><td class="num">4.25</td></tr>
      <tr><td class="num line">441</td><td><a href="addressmap.c.html#L441">(!(flags & AMR_FLAG_USE_MAPADDRESS))</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">445</td><td><a href="addressmap.c.html#L445">(!(flags & AMR_FLAG_USE_AUTOMAP))</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">449</td><td><a href="addressmap.c.html#L449">(!(flags & AMR_FLAG_USE_TRACKEXIT))</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">177</td><td><a href="addressmap.c.html#L177">(!addressmap || !exitname)</a></td><td class="num">3.75</td></tr>
      <tr><td class="num line">359</td><td><a href="addressmap.c.html#L359">(val->dst_wildcard)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">600</td><td><a href="addressmap.c.html#L600">(ent->new_address)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">953</td><td><a href="addressmap.c.html#L953">(attempts--)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1138</td><td><a href="addressmap.c.html#L1138">(val->new_address)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">1043</td><td><a href="addressmap.c.html#L1043">(!*addrp)</a></td><td class="num">3.00</td></tr>
      <tr><td class="num line">743</td><td><a href="addressmap.c.html#L743">(tor_addr_family(val) == AF_INET)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">746</td><td><a href="addressmap.c.html#L746">(tor_addr_family(val) == AF_INET6)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">226</td><td><a href="addressmap.c.html#L226">(len < 6)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">397</td><td><a href="addressmap.c.html#L397">(rewrites < 16)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">601</td><td><a href="addressmap.c.html#L601">(expires > 1)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">693</td><td><a href="addressmap.c.html#L693">(ttl < 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">839</td><td><a href="addressmap.c.html#L839">(bits > max_prefix_bits)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">930</td><td><a href="addressmap.c.html#L930">(type == RESOLVED_TYPE_HOSTNAME)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">1016</td><td><a href="addressmap.c.html#L1016">(type == RESOLVED_TYPE_IPV4)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">1018</td><td><a href="addressmap.c.html#L1018">(type == RESOLVED_TYPE_IPV6)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">1023</td><td><a href="addressmap.c.html#L1023">(*addrp)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">1099</td><td><a href="addressmap.c.html#L1099">(*address)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">258</td><td><a href="addressmap.c.html#L258">(!strcmp(suffix, "."))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">260</td><td><a href="addressmap.c.html#L260">(!strcasecmpend(address, suffix))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">751</td><td><a href="addressmap.c.html#L751">(!tor_addr_to_str(valbuf, val, sizeof(valbuf), 1))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">864</td><td><a href="addressmap.c.html#L864">(!strcasecmpend(address, ".virtual"))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">964</td><td><a href="addressmap.c.html#L964">(!strmap_get(addressmap, buf))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">1130</td><td><a href="addressmap.c.html#L1130">(!strmap_iter_done(iter))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">103</td><td><a href="addressmap.c.html#L103">(!ent)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">123</td><td><a href="addressmap.c.html#L123">(!ent)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">202</td><td><a href="addressmap.c.html#L202">(!addressmap)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">215</td><td><a href="addressmap.c.html#L215">(!target)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">254</td><td><a href="addressmap.c.html#L254">(!suffix_list)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">276</td><td><a href="addressmap.c.html#L276">(!addressmap)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">279</td><td><a href="addressmap.c.html#L279">(!suffixes)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">287</td><td><a href="addressmap.c.html#L287">(!remove_this)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">597</td><td><a href="addressmap.c.html#L597">(!ent)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">641</td><td><a href="addressmap.c.html#L641">(!ent)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">956</td><td><a href="addressmap.c.html#L956">(!ipv6)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">1011</td><td><a href="addressmap.c.html#L1011">(!vent)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">1127</td><td><a href="addressmap.c.html#L1127">(!addressmap)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">1134</td><td><a href="addressmap.c.html#L1134">(!sl)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">204</td><td><a href="addressmap.c.html#L204">(routerset_is_empty(allow_nodes))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">218</td><td><a href="addressmap.c.html#L218">(strcmpend(target, ".exit"))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">936</td><td><a href="addressmap.c.html#L936">(strmap_get(addressmap, buf))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">969</td><td><a href="addressmap.c.html#L969">(strmap_get(addressmap, tmp))</a></td><td class="num">0.25</td></tr>
      <tr><td class="num line">147</td><td><a href="addressmap.c.html#L147">(ve)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">294</td><td><a href="addressmap.c.html#L294">(remove_this)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">490</td><td><a href="addressmap.c.html#L490">(exit_source_out)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">492</td><td><a href="addressmap.c.html#L492">(expires_out)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">523</td><td><a href="addressmap.c.html#L523">(ent)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">532</td><td><a href="addressmap.c.html#L532">(expires_out)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">583</td><td><a href="addressmap.c.html#L583">(wildcard_new_addr)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">591</td><td><a href="addressmap.c.html#L591">(ent)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">663</td><td><a href="addressmap.c.html#L663">(ent)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">689</td><td><a href="addressmap.c.html#L689">(for_conn)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">698</td><td><a href="addressmap.c.html#L698">(exitname)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">813</td><td><a href="addressmap.c.html#L813">(msg)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">819</td><td><a href="addressmap.c.html#L819">(msg)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">825</td><td><a href="addressmap.c.html#L825">(msg)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">832</td><td><a href="addressmap.c.html#L832">(msg)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">840</td><td><a href="addressmap.c.html#L840">(msg)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">846</td><td><a href="addressmap.c.html#L846">(validate_only)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">890</td><td><a href="addressmap.c.html#L890">(ipv6)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">909</td><td><a href="addressmap.c.html#L909">(ipv6)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">1049</td><td><a href="addressmap.c.html#L1049">(vent_needs_to_be_added)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">1084</td><td><a href="addressmap.c.html#L1084">(client)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">1141</td><td><a href="addressmap.c.html#L1141">(want_expiry)</a></td><td class="num">0.00</td></tr>

    </table>
  </fieldset>
  
  <footer class="footer width-full container-xl p-responsive">
    <nav>
      <p></p>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Merly" href="https://merly.ai">Â© 2022 Merly, Inc.</a></li>
        <!--
        <li class="mr-3"><a>Terms</a></li>
        <li class="mr-3"><a>Privacy</a></li>
        <li class="mr-3"><a>Security</a></li>
        -->
        <li class="mr-3"><a href="https://merly.ai/_files/ugd/c392f8_90d33fd2e7644dcd9aa97ac2b7736c75.pdf">User Manual</a></li>
        <li class="mr-3"><a href="mailto:sales@merly.ai">Contact Merly</a></li>
        <li class="mr-3"><a href="https://merly.ai/mentor-pricing">Pricing</a></li>
        <li class="mr-3"><a href="https://merly.ai/timeline">About</a></li>
      </ul>
    </nav>
  </footer>

</body>
</html>
