
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" href="../../merly.css">
  <title>qemu Repo - backends\tpm\tpm_emulator.c Ctrl Expressions (67) - MerlyMentor</title>
</head>
<body>
  <h2>qemu Repo - backends\tpm\tpm_emulator.c Ctrl Expressions (67) - MerlyMentor</h2>
  
  <header>
    <nav>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Files" href="../../index.html">Files</a></li>
        <li class="mr-3"><a title="Anomalies" href="../../anomalies.html">Anomalies</a></li>
        <li class="mr-3"><a title="Notables" href="../../notables.html">Notables</a></li>
        <li class="mr-3"><a title="Known Good" href="../../known-good.html">Known Good</a></li>
        <li class="mr-3"><a title="Known Bad" href="../../known-bad.html">Known Bad</a></li>
        
      </ul>
    </nav>
  </header>

  <fieldset>
    <legend>&nbsp;backends\tpm\tpm_emulator.c Ctrl Expressions (67)&nbsp;</legend>
    <table class="code">
      <tr class="th"><td class="num">Line</td><td>Ctrl Expression</td><td class="num">Score</td></tr>
      <tr><td class="num line">719</td><td><a href="tpm_emulator.c.html#L719">(<span style='background-color:#9c4c02;'>tpm_emulator_get_state_blob(tpm_emu, PTM_BLOB_TYPE_PERMANENT, &state_blobs->permanent, &state_blobs->permanent_flags) < 0 || tpm_emulator_get_state_blob(tpm_emu, PTM_BLOB_TYPE_VOLATILE, &state_blobs->volatil, &state_blobs->volatil_flags) < 0 || tpm_emulator_get_state_blob(tpm_emu, PTM_BLOB_TYPE_SAVESTATE, &state_blobs->savestate, &state_blobs->savestate_flags) < 0</span>)</a></td><td class="num">104.75</td></tr>
      <tr><td class="num line">825</td><td><a href="tpm_emulator.c.html#L825">(tpm_emulator_set_state_blob(tpm_emu, PTM_BLOB_TYPE_PERMANENT, &state_blobs->permanent, state_blobs->permanent_flags) < 0 || tpm_emulator_set_state_blob(tpm_emu, PTM_BLOB_TYPE_VOLATILE, &state_blobs->volatil, state_blobs->volatil_flags) < 0 || tpm_emulator_set_state_blob(tpm_emu, PTM_BLOB_TYPE_SAVESTATE, &state_blobs->savestate, state_blobs->savestate_flags) < 0)</a></td><td class="num">98.00</td></tr>
      <tr><td class="num line">228</td><td><a href="tpm_emulator.c.html#L228">(tpm_emulator_set_locality(tpm_emu, cmd->locty, errp) < 0 || tpm_emulator_unix_tx_bufs(tpm_emu, cmd->in, cmd->in_len, cmd->out, cmd->out_len, &cmd->selftest_done, errp) < 0)</a></td><td class="num">59.50</td></tr>
      <tr><td class="num line">578</td><td><a href="tpm_emulator.c.html#L578">(tpm_util_test_tpmdev(QIO_CHANNEL_SOCKET(tpm_emu->data_ioc)->fd, &tpm_emu->tpm_version))</a></td><td class="num">51.25</td></tr>
      <tr><td class="num line">520</td><td><a href="tpm_emulator.c.html#L520">(tpm_emulator_ctrlcmd(tpm_emu, CMD_SET_DATAFD, &res, 0, sizeof(res)) < 0 || res != 0)</a></td><td class="num">25.00</td></tr>
      <tr><td class="num line">562</td><td><a href="tpm_emulator.c.html#L562">(!qemu_chr_fe_init(&tpm_emu->ctrl_chr, dev, &err))</a></td><td class="num">25.00</td></tr>
      <tr><td class="num line">238</td><td><a href="tpm_emulator.c.html#L238">(tpm_emulator_ctrlcmd(tpm_emu, CMD_GET_CAPABILITY, &tpm_emu->caps, 0, sizeof(tpm_emu->caps)) < 0)</a></td><td class="num">23.75</td></tr>
      <tr><td class="num line">666</td><td><a href="tpm_emulator.c.html#L666">(tpm_emulator_ctrlcmd(tpm_emu, CMD_GET_STATEBLOB, &pgs, sizeof(pgs.u.req), offsetof(ptm_getstate, u.resp.data)) < 0)</a></td><td class="num">22.50</td></tr>
      <tr><td class="num line">769</td><td><a href="tpm_emulator.c.html#L769">(tpm_emulator_ctrlcmd(tpm_emu, CMD_SET_STATEBLOB, &pss, offsetof(ptm_setstate, u.req.data), 0) < 0)</a></td><td class="num">22.50</td></tr>
      <tr><td class="num line">675</td><td><a href="tpm_emulator.c.html#L675">(res != 0 && (res & 0x800) == 0)</a></td><td class="num">11.50</td></tr>
      <tr><td class="num line">356</td><td><a href="tpm_emulator.c.html#L356">(buffersize != 0 && tpm_emulator_set_buffer_size(tb, buffersize, NULL) < 0)</a></td><td class="num">8.50</td></tr>
      <tr><td class="num line">495</td><td><a href="tpm_emulator.c.html#L495">(migrate_add_blocker(tpm_emu->migration_blocker, &err) < 0)</a></td><td class="num">8.00</td></tr>
      <tr><td class="num line">926</td><td><a href="tpm_emulator.c.html#L926">(!tpm_emu->options->chardev)</a></td><td class="num">6.00</td></tr>
      <tr><td class="num line">114</td><td><a href="tpm_emulator.c.html#L114">(tpm_errors[i].tpm_result == tpm_result)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">194</td><td><a href="tpm_emulator.c.html#L194">(tpm_emu->cur_locty_number == locty_number)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">420</td><td><a href="tpm_emulator.c.html#L420">(tpm_emu->tpm_version != TPM_VERSION_2_0)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">758</td><td><a href="tpm_emulator.c.html#L758">(tsb->size == 0)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">778</td><td><a href="tpm_emulator.c.html#L778">(n != tsb->size)</a></td><td class="num">5.50</td></tr>
      <tr><td class="num line">202</td><td><a href="tpm_emulator.c.html#L202">(tpm_emulator_ctrlcmd(tpm_emu, CMD_SET_LOCALITY, &loc, sizeof(loc), sizeof(loc)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">289</td><td><a href="tpm_emulator.c.html#L289">(tpm_emulator_ctrlcmd(tpm_emu, CMD_STOP, &res, 0, sizeof(res)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">318</td><td><a href="tpm_emulator.c.html#L318">(tpm_emulator_ctrlcmd(tpm_emu, CMD_SET_BUFFERSIZE, &psbs, sizeof(psbs.u.req), sizeof(psbs.u.resp)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">365</td><td><a href="tpm_emulator.c.html#L365">(tpm_emulator_ctrlcmd(tpm_emu, CMD_INIT, &init, sizeof(init), sizeof(init)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">398</td><td><a href="tpm_emulator.c.html#L398">(tpm_emulator_ctrlcmd(tpm_emu, CMD_GET_TPMESTABLISHED, &est, 0, sizeof(est)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">425</td><td><a href="tpm_emulator.c.html#L425">(tpm_emulator_ctrlcmd(tpm_emu, CMD_RESET_TPMESTABLISHED, &reset_est, sizeof(reset_est), sizeof(reset_est)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">457</td><td><a href="tpm_emulator.c.html#L457">(tpm_emulator_ctrlcmd(tpm_emu, CMD_CANCEL_TPM_CMD, &res, 0, sizeof(res)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">478</td><td><a href="tpm_emulator.c.html#L478">(tpm_emulator_set_buffer_size(tb, 0, &actual_size) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">931</td><td><a href="tpm_emulator.c.html#L931">(tpm_emulator_ctrlcmd(tpm_emu, CMD_SHUTDOWN, &res, 0, sizeof(res)) < 0)</a></td><td class="num">4.75</td></tr>
      <tr><td class="num line">210</td><td><a href="tpm_emulator.c.html#L210">(loc.u.resp.tpm_result != 0)</a></td><td class="num">4.25</td></tr>
      <tr><td class="num line">326</td><td><a href="tpm_emulator.c.html#L326">(psbs.u.resp.tpm_result != 0)</a></td><td class="num">4.25</td></tr>
      <tr><td class="num line">694</td><td><a href="tpm_emulator.c.html#L694">(!tsb->buffer)</a></td><td class="num">4.00</td></tr>
      <tr><td class="num line">394</td><td><a href="tpm_emulator.c.html#L394">(tpm_emu->established_flag_cached)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">953</td><td><a href="tpm_emulator.c.html#L953">(tpm_emu->migration_blocker)</a></td><td class="num">3.25</td></tr>
      <tr><td class="num line">596</td><td><a href="tpm_emulator.c.html#L596">(tpm_emulator_probe_caps(tpm_emu) || tpm_emulator_check_caps(tpm_emu))</a></td><td class="num">2.75</td></tr>
      <tr><td class="num line">113</td><td><a href="tpm_emulator.c.html#L113">(i < ARRAY_SIZE(tpm_errors))</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">312</td><td><a href="tpm_emulator.c.html#L312">(tpm_emulator_stop_tpm(tb) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">513</td><td><a href="tpm_emulator.c.html#L513">(socketpair(AF_UNIX, SOCK_STREAM, 0, fds) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">571</td><td><a href="tpm_emulator.c.html#L571">(tpm_emulator_prepare_data_fd(tpm_emu) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">820</td><td><a href="tpm_emulator.c.html#L820">(tpm_emulator_stop_tpm(tb) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">870</td><td><a href="tpm_emulator.c.html#L870">(tpm_emulator_startup_tpm_resume(tb, 0, true) < 0)</a></td><td class="num">2.50</td></tr>
      <tr><td class="num line">135</td><td><a href="tpm_emulator.c.html#L135">(n <= 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">139</td><td><a href="tpm_emulator.c.html#L139">(msg_len_out != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">141</td><td><a href="tpm_emulator.c.html#L141">(n <= 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">165</td><td><a href="tpm_emulator.c.html#L165">(ret != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">171</td><td><a href="tpm_emulator.c.html#L171">(ret != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">178</td><td><a href="tpm_emulator.c.html#L178">(ret != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">461</td><td><a href="tpm_emulator.c.html#L461">(res != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">684</td><td><a href="tpm_emulator.c.html#L684">(totlength != length)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">692</td><td><a href="tpm_emulator.c.html#L692">(totlength > 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">701</td><td><a href="tpm_emulator.c.html#L701">(n != totlength)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">788</td><td><a href="tpm_emulator.c.html#L788">(n != sizeof(pss.u.resp))</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">796</td><td><a href="tpm_emulator.c.html#L796">(tpm_result != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">866</td><td><a href="tpm_emulator.c.html#L866">(ret < 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">934</td><td><a href="tpm_emulator.c.html#L934">(res != 0)</a></td><td class="num">2.25</td></tr>
      <tr><td class="num line">275</td><td><a href="tpm_emulator.c.html#L275">(!TPM_EMULATOR_IMPLEMENTS_ALL_CAPS(tpm_emu, caps))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">451</td><td><a href="tpm_emulator.c.html#L451">(!TPM_EMULATOR_IMPLEMENTS_ALL_CAPS(tpm_emu, PTM_CAP_CANCEL_TPM_CMD))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">491</td><td><a href="tpm_emulator.c.html#L491">(!TPM_EMULATOR_IMPLEMENTS_ALL_CAPS(tpm_emu, caps))</a></td><td class="num">1.00</td></tr>
      <tr><td class="num line">551</td><td><a href="tpm_emulator.c.html#L551">(!value)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">557</td><td><a href="tpm_emulator.c.html#L557">(!dev)</a></td><td class="num">0.75</td></tr>
      <tr><td class="num line">613</td><td><a href="tpm_emulator.c.html#L613">(tpm_emulator_handle_device_opts(TPM_EMULATOR(tb), opts))</a></td><td class="num">0.50</td></tr>
      <tr><td class="num line">159</td><td><a href="tpm_emulator.c.html#L159">(selftest_done)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">182</td><td><a href="tpm_emulator.c.html#L182">(is_selftest)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">296</td><td><a href="tpm_emulator.c.html#L296">(res)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">333</td><td><a href="tpm_emulator.c.html#L333">(actual_size)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">361</td><td><a href="tpm_emulator.c.html#L361">(is_resume)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">373</td><td><a href="tpm_emulator.c.html#L373">(res)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">434</td><td><a href="tpm_emulator.c.html#L434">(res)</a></td><td class="num">0.00</td></tr>
      <tr><td class="num line">528</td><td><a href="tpm_emulator.c.html#L528">(err)</a></td><td class="num">0.00</td></tr>

    </table>
  </fieldset>
  
  <footer class="footer width-full container-xl p-responsive">
    <nav>
      <p></p>
      <ul class="list-style-none d-flex flex-wrap mb-2">
        <li class="mr-3"><a title="Merly" href="https://merly.ai">Â© 2022 Merly, Inc.</a></li>
        <!--
        <li class="mr-3"><a>Terms</a></li>
        <li class="mr-3"><a>Privacy</a></li>
        <li class="mr-3"><a>Security</a></li>
        -->
        <li class="mr-3"><a href="https://merly.ai/_files/ugd/c392f8_90d33fd2e7644dcd9aa97ac2b7736c75.pdf">User Manual</a></li>
        <li class="mr-3"><a href="mailto:sales@merly.ai">Contact Merly</a></li>
        <li class="mr-3"><a href="https://merly.ai/mentor-pricing">Pricing</a></li>
        <li class="mr-3"><a href="https://merly.ai/timeline">About</a></li>
      </ul>
    </nav>
  </footer>

</body>
</html>
